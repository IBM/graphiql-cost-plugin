import e,{useState as t}from"react";function n(t){return t.num>=2147483647?e.createElement("span",null,"∞ "):e.createElement("span",null,t.num%1!=0?t.num.toFixed(2):t.num.toString()," ")}function r(t){var n=e.useState(!1),r=n[0],a=n[1];if(!Array.isArray(t.details)||0===t.details.length)return null;var l=e.createElement("div",null,e.createElement("h3",{style:{marginBlockStart:0,marginBlockEnd:0}},t.title),e.createElement("ul",{style:{marginBlockStart:5,marginBlockEnd:5}},t.details.map(function(t,n){return e.createElement("li",{key:n},t)})));return e.createElement("span",{style:{marginLeft:"0.2rem",color:"gray",borderBottom:"1px dotted gray",cursor:"pointer",position:"relative"},onMouseEnter:function(){return a(!0)},onMouseLeave:function(){return a(!1)}},"ℹ",e.createElement("div",{style:{display:r?"block":"none",zIndex:1e3,position:"absolute",borderRadius:"5px",backgroundColor:"#111",color:"white",bottom:15,width:170,padding:5,right:-50}},l))}function a(t){var a=t.characteristics,l=a.typeCounts&&Object.keys(a.typeCounts).map(function(t){return e.createElement("span",null,t,": ",e.createElement(n,{num:a.typeCounts[t]}))})||null,i=a.fieldCounts&&Object.keys(a.fieldCounts).map(function(t){return e.createElement("span",null,t,": ",e.createElement(n,{num:a.fieldCounts[t]}))})||null;return e.createElement("div",{style:{padding:"0.5em 0 0.5em 0.5em"}},e.createElement("h3",{style:{marginBlockStart:"0.2em",marginBlockEnd:0}},"Query cost"),e.createElement("div",{style:{paddingLeft:"0.5em"}},"Type cost: ",e.createElement(n,{num:a.typeCost}),e.createElement(r,{title:"Type counts",details:l})," "),e.createElement("div",{style:{paddingLeft:"0.5em"}},"Field cost: ",e.createElement(n,{num:a.fieldCost}),e.createElement(r,{title:"Field counts",details:i})," "))}function l(e,t){return 0===e||0===t?Number.MAX_SAFE_INTEGER:Math.floor(e/t)}function i(t){var a=t.timeFrame,i=t.limits,m=t.characteristics,c=i.find(function(e){return"typeCost"===e.name}),o=i.find(function(e){return"fieldCost"===e.name}),s=m.typeCounts&&Object.keys(m.typeCounts).map(function(t){return e.createElement("span",null,t,": ",e.createElement(n,{num:m.typeCounts[t]}))})||null,u=m.fieldCounts&&Object.keys(m.fieldCounts).map(function(t){return e.createElement("span",null,t,": ",e.createElement(n,{num:m.fieldCounts[t]}))})||null;return e.createElement("div",null,e.createElement("h4",{style:{marginBlockStart:"0.3em",marginBlockEnd:0}},"Limits for ",a.interval," ",a.unit,":"),e.createElement("div",null,c?e.createElement("span",{style:{paddingLeft:"0.5em"}},e.createElement(n,{num:l(c.rate,m.typeCost)}),"times for type cost of ",e.createElement(n,{num:m.typeCost}),e.createElement(r,{title:"Type counts",details:s})):e.createElement("span",{style:{color:"gray",paddingLeft:"0.5em"}},"No limit defined for type cost")),e.createElement("div",null,o?e.createElement("span",{style:{paddingLeft:"0.5em"}},e.createElement(n,{num:l(o.rate,m.fieldCost)}),"times for field cost of ",e.createElement(n,{num:m.fieldCost}),e.createElement(r,{title:"Field counts",details:u})):e.createElement("span",{style:{color:"gray",paddingLeft:"0.5em"}},"No limit defined for field cost")))}function m(){return e.createElement("div",{style:{width:0,height:0,borderTop:"8px solid transparent",borderBottom:"8px solid transparent",borderRight:"8px solid #444",float:"right"}})}function c(e,t,n){Array.isArray(e)&&0!==e.length&&e.forEach(function(e){var r=t.find(function(t){return t.timeFrame.interval===e.interval&&t.timeFrame.unit===e.unit});r?r.limits.push({name:n,rate:e.rate}):t.push({timeFrame:{interval:e.interval,unit:e.unit},limits:[{name:n,rate:e.rate}]})})}function o(r){var a,l,o,s=r.characteristics,u=r.rateLimits,d=t(null),E=d[0],p=d[1],f=null==(a=u.assemblyRateLimits)?void 0:a["graphql-field-cost"],y=null==(l=u.assemblyRateLimits)?void 0:l["graphql-type-cost"],g=null==(o=u.assemblyRateLimits)?void 0:o["graphql-type-cost"],v=[];c(f,v,"fieldCost"),c(y,v,"typeCost"),c(g,v,"inputTypeCost");var h=E?e.createElement(i,{timeFrame:E.timeFrame,characteristics:s,limits:E.limits}):null,b=e.createElement("div",null,e.createElement("h3",{style:{marginBlockStart:"0.2em",marginBlockEnd:0}},"Query limits:"),v.map(function(t,r){var a=function(e,t){var n=Number.MAX_SAFE_INTEGER;return e.forEach(function(e){var r=e.rate,a=t[e.name],l="number"==typeof a&&0!==a&&0!==r?Math.floor(r/a):Number.MAX_SAFE_INTEGER;l<n&&(n=l)}),n}(t.limits,s),l=!!E&&t.timeFrame.interval===E.timeFrame.interval&&t.timeFrame.unit===E.timeFrame.unit,i=e.createElement("span",{onClick:function(){return e=t,void p(E&&E.timeFrame.interval===e.timeFrame.interval&&E.timeFrame.unit===e.timeFrame.unit?null:e);var e},style:{fontStyle:"italic",textDecorationStyle:"dotted",cursor:"pointer",paddingLeft:10}},l?"hide...":"more...");return e.createElement("div",{key:r,style:{paddingLeft:"0.5em"}},e.createElement(n,{num:a}),"times per ",t.timeFrame.interval," ",t.timeFrame.unit,i,l?e.createElement(m,null):null)})),C=h?e.createElement(e.Fragment,null,e.createElement("div",{style:{width:250,padding:"0.5em 0 0.5em 0.5em"}},b),e.createElement("div",{style:{flex:1,backgroundColor:"#444",color:"white",padding:"0.5em 0 0.5em 0.5em"}},h)):e.createElement(e.Fragment,null,e.createElement("div",{style:{flex:1,padding:"0.5em 0 0.5em 0.5em"}},b));return e.createElement("div",{style:{display:"flex",flexDirection:"row",width:"100%",height:"100%"}},C)}function s(t){var n,r=t.costData;switch(t.dataAvailability){case"NONE":n=e.createElement("h3",{style:{color:"#cdcdcd",textAlign:"center"}},"No data yet");break;case"LOADING":n=e.createElement("h3",{style:{color:"#cdcdcd",textAlign:"center"}},"Loading...");break;case"ERROR":n=e.createElement("h3",{style:{color:"#cdcdcd",textAlign:"center"}},"Error loading cost data");break;case"AVAILABLE":n="object"==typeof r&&"object"==typeof r.request&&"object"==typeof r.rateLimits?e.createElement(o,{characteristics:r.request,rateLimits:r.rateLimits}):"object"==typeof r.request?e.createElement(a,{characteristics:r.request}):e.createElement("h3",{style:{color:"#cdcdcd",textAlign:"center"}},"Error rendering cost data")}return e.createElement("div",{className:"qcs_wrapper"},n)}export{s as CostPlugin};
//# sourceMappingURL=index.esm.js.map
