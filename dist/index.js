var e,t=require("react"),n=(e=t)&&"object"==typeof e&&"default"in e?e.default:e;function r(e){return e.num>=2147483647?n.createElement("span",null,"∞ "):n.createElement("span",null,e.num%1!=0?e.num.toFixed(2):e.num.toString()," ")}function a(e){var t=n.useState(!1),r=t[0],a=t[1];if(!Array.isArray(e.details)||0===e.details.length)return null;var i=n.createElement("div",null,n.createElement("h3",{style:{marginBlockStart:0,marginBlockEnd:0}},e.title),n.createElement("ul",{style:{marginBlockStart:5,marginBlockEnd:5}},e.details.map(function(e,t){return n.createElement("li",{key:t},e)})));return n.createElement("span",{style:{marginLeft:"0.2rem",color:"gray",borderBottom:"1px dotted gray",cursor:"pointer",position:"relative"},onMouseEnter:function(){return a(!0)},onMouseLeave:function(){return a(!1)}},"ℹ",n.createElement("div",{style:{display:r?"block":"none",zIndex:1e3,position:"absolute",borderRadius:"5px",backgroundColor:"#111",color:"white",bottom:15,width:170,padding:5,right:-50}},i))}function i(e){var t=e.characteristics,i=Object.keys(t.typeCounts).map(function(e){return n.createElement("span",null,e,": ",n.createElement(r,{num:t.typeCounts[e]}))}),l=Object.keys(t.fieldCounts).map(function(e){return n.createElement("span",null,e,": ",n.createElement(r,{num:t.fieldCounts[e]}))});return n.createElement("div",{style:{padding:"0.5em 0 0.5em 0.5em"}},n.createElement("h3",{style:{marginBlockStart:"0.2em",marginBlockEnd:0}},"Query cost"),n.createElement("div",{style:{paddingLeft:"0.5em"}},"Type cost: ",n.createElement(r,{num:t.typeCost}),n.createElement(a,{title:"Type counts",details:i})," "),n.createElement("div",{style:{paddingLeft:"0.5em"}},"Field cost: ",n.createElement(r,{num:t.fieldCost}),n.createElement(a,{title:"Field counts",details:l})," "))}function l(e,t){return 0===e||0===t?Number.MAX_SAFE_INTEGER:Math.floor(e/t)}function m(e){var t=e.timeFrame,i=e.limits,m=e.characteristics,c=i.find(function(e){return"typeCost"===e.name}),o=i.find(function(e){return"fieldCost"===e.name}),s=Object.keys(m.typeCounts).map(function(e){return n.createElement("span",null,e,": ",n.createElement(r,{num:m.typeCounts[e]}))}),u=Object.keys(m.fieldCounts).map(function(e){return n.createElement("span",null,e,": ",n.createElement(r,{num:m.fieldCounts[e]}))});return n.createElement("div",null,n.createElement("h4",{style:{marginBlockStart:"0.3em",marginBlockEnd:0}},"Limits for ",t.interval," ",t.unit,":"),n.createElement("div",null,c?n.createElement("span",{style:{paddingLeft:"0.5em"}},n.createElement(r,{num:l(c.rate,m.typeCost)}),"times for type cost of ",n.createElement(r,{num:m.typeCost}),n.createElement(a,{title:"Type counts",details:s})):n.createElement("span",{style:{color:"gray",paddingLeft:"0.5em"}},"No limit defined for type cost")),n.createElement("div",null,o?n.createElement("span",{style:{paddingLeft:"0.5em"}},n.createElement(r,{num:l(o.rate,m.fieldCost)}),"times for field cost of ",n.createElement(r,{num:m.fieldCost}),n.createElement(a,{title:"Field counts",details:u})):n.createElement("span",{style:{color:"gray",paddingLeft:"0.5em"}},"No limit defined for field cost")))}function c(){return n.createElement("div",{style:{width:0,height:0,borderTop:"8px solid transparent",borderBottom:"8px solid transparent",borderRight:"8px solid #444",float:"right"}})}function o(e,t,n){Array.isArray(e)&&0!==e.length&&e.forEach(function(e){var r=t.find(function(t){return t.timeFrame.interval===e.interval&&t.timeFrame.unit===e.unit});r?r.limits.push({name:n,rate:e.rate}):t.push({timeFrame:{interval:e.interval,unit:e.unit},limits:[{name:n,rate:e.rate}]})})}function s(e){var a,i,l,s=e.characteristics,u=e.rateLimits,d=t.useState(null),E=d[0],p=d[1],f=null==(a=u.assemblyRateLimits)?void 0:a["graphql-field-cost"],y=null==(i=u.assemblyRateLimits)?void 0:i["graphql-type-cost"],g=null==(l=u.assemblyRateLimits)?void 0:l["graphql-type-cost"],v=[];o(f,v,"fieldCost"),o(y,v,"typeCost"),o(g,v,"inputTypeCost");var h=E?n.createElement(m,{timeFrame:E.timeFrame,characteristics:s,limits:E.limits}):null,b=n.createElement("div",null,n.createElement("h3",{style:{marginBlockStart:"0.2em",marginBlockEnd:0}},"Query limits:"),v.map(function(e,t){var a=function(e,t){var n=Number.MAX_SAFE_INTEGER;return e.forEach(function(e){var r=e.rate,a=t[e.name],i="number"==typeof a&&0!==a&&0!==r?Math.floor(r/a):Number.MAX_SAFE_INTEGER;i<n&&(n=i)}),n}(e.limits,s),i=!!E&&e.timeFrame.interval===E.timeFrame.interval&&e.timeFrame.unit===E.timeFrame.unit,l=n.createElement("span",{onClick:function(){return t=e,void p(E&&E.timeFrame.interval===t.timeFrame.interval&&E.timeFrame.unit===t.timeFrame.unit?null:t);var t},style:{fontStyle:"italic",textDecorationStyle:"dotted",cursor:"pointer",paddingLeft:10}},i?"hide...":"more...");return n.createElement("div",{key:t,style:{paddingLeft:"0.5em"}},n.createElement(r,{num:a}),"times per ",e.timeFrame.interval," ",e.timeFrame.unit,l,i?n.createElement(c,null):null)})),F=h?n.createElement(n.Fragment,null,n.createElement("div",{style:{width:250,padding:"0.5em 0 0.5em 0.5em"}},b),n.createElement("div",{style:{flex:1,backgroundColor:"#444",color:"white",padding:"0.5em 0 0.5em 0.5em"}},h)):n.createElement(n.Fragment,null,n.createElement("div",{style:{flex:1,padding:"0.5em 0 0.5em 0.5em"}},b));return n.createElement("div",{style:{display:"flex",flexDirection:"row",width:"100%",height:"100%"}},F)}exports.CostPlugin=function(e){var t,r=e.costData;switch(e.dataAvailability){case"NONE":t=n.createElement("h3",{style:{color:"#cdcdcd",textAlign:"center"}},"No data yet");break;case"LOADING":t=n.createElement("h3",{style:{color:"#cdcdcd",textAlign:"center"}},"Loading...");break;case"ERROR":t=n.createElement("h3",{style:{color:"#cdcdcd",textAlign:"center"}},"Error loading cost data");break;case"AVAILABLE":t="object"==typeof r&&"object"==typeof r.request&&"object"==typeof r.rateLimits?n.createElement(s,{characteristics:r.request,rateLimits:r.rateLimits}):"object"==typeof r.request?n.createElement(i,{characteristics:r.request}):n.createElement("h3",{style:{color:"#cdcdcd",textAlign:"center"}},"Error rendering cost data")}return n.createElement("div",{className:"qcs_wrapper"},t)};
//# sourceMappingURL=index.js.map
