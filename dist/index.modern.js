import e,{useState as t}from"react";function n(t){return t.num>=2147483647?e.createElement("span",null,"∞ "):e.createElement("span",null,t.num%1!=0?t.num.toFixed(2):t.num.toString()," ")}function r(t){const[n,r]=e.useState(!1);if(!Array.isArray(t.details)||0===t.details.length)return null;const l=e.createElement("div",null,e.createElement("h3",{style:{marginBlockStart:0,marginBlockEnd:0}},t.title),e.createElement("ul",{style:{marginBlockStart:5,marginBlockEnd:5}},t.details.map((t,n)=>e.createElement("li",{key:n},t))));return e.createElement("span",{style:{marginLeft:"0.2rem",color:"gray",borderBottom:"1px dotted gray",cursor:"pointer",position:"relative"},onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1)},"ℹ",e.createElement("div",{style:{display:n?"block":"none",zIndex:1e3,position:"absolute",borderRadius:"5px",backgroundColor:"#111",color:"white",bottom:15,width:"max-content",padding:5,right:-50}},l))}function l({characteristics:t}){const l=t.typeCounts&&Object.keys(t.typeCounts).map(r=>e.createElement("span",null,r,": ",e.createElement(n,{num:t.typeCounts[r]})))||null,a=t.fieldCounts&&Object.keys(t.fieldCounts).map(r=>e.createElement("span",null,r,": ",e.createElement(n,{num:t.fieldCounts[r]})))||null;return e.createElement("div",{style:{padding:"0.5em 0 0.5em 0.5em"}},e.createElement("h3",{style:{marginBlockStart:"0.2em",marginBlockEnd:0}},"Query cost"),e.createElement("div",{style:{paddingLeft:"0.5em"}},"Type cost: ",e.createElement(n,{num:t.typeCost}),e.createElement(r,{title:"Type counts",details:l})," "),e.createElement("div",{style:{paddingLeft:"0.5em"}},"Field cost: ",e.createElement(n,{num:t.fieldCost}),e.createElement(r,{title:"Field counts",details:a})," "))}function a(e,t){return 0===e||0===t?Number.MAX_SAFE_INTEGER:Math.floor(e/t)}function i({timeFrame:t,limits:l,characteristics:i}){const m=l.find(e=>"typeCost"===e.name),c=l.find(e=>"fieldCost"===e.name),o=i.typeCounts&&Object.keys(i.typeCounts).map(t=>e.createElement("span",null,t,": ",e.createElement(n,{num:i.typeCounts[t]})))||null,s=i.fieldCounts&&Object.keys(i.fieldCounts).map(t=>e.createElement("span",null,t,": ",e.createElement(n,{num:i.fieldCounts[t]})))||null;return e.createElement("div",null,e.createElement("h4",{style:{marginBlockStart:"0.3em",marginBlockEnd:0}},"Limits for ",t.interval," ",t.unit,":"),e.createElement("div",null,m?e.createElement("span",{style:{paddingLeft:"0.5em"}},e.createElement(n,{num:a(m.rate,i.typeCost)}),"times for type cost of ",e.createElement(n,{num:i.typeCost}),e.createElement(r,{title:"Type counts",details:o})):e.createElement("span",{style:{color:"gray",paddingLeft:"0.5em"}},"No limit defined for type cost")),e.createElement("div",null,c?e.createElement("span",{style:{paddingLeft:"0.5em"}},e.createElement(n,{num:a(c.rate,i.fieldCost)}),"times for field cost of ",e.createElement(n,{num:i.fieldCost}),e.createElement(r,{title:"Field counts",details:s})):e.createElement("span",{style:{color:"gray",paddingLeft:"0.5em"}},"No limit defined for field cost")))}function m(){return e.createElement("div",{style:{width:0,height:0,borderTop:"8px solid transparent",borderBottom:"8px solid transparent",borderRight:"8px solid #444",float:"right"}})}function c(e,t,n){Array.isArray(e)&&0!==e.length&&e.forEach(e=>{const r=t.find(t=>t.timeFrame.interval===e.interval&&t.timeFrame.unit===e.unit);r?r.limits.push({name:n,rate:e.rate}):t.push({timeFrame:{interval:e.interval,unit:e.unit},limits:[{name:n,rate:e.rate}]})})}function o({characteristics:r,rateLimits:l}){var a,o,s;const[d,u]=t(null),E=null==(a=l.assemblyRateLimits)?void 0:a["graphql-field-cost"],p=null==(o=l.assemblyRateLimits)?void 0:o["graphql-type-cost"],y=null==(s=l.assemblyRateLimits)?void 0:s["graphql-type-cost"],f=[];c(E,f,"fieldCost"),c(p,f,"typeCost"),c(y,f,"inputTypeCost");let g=d?e.createElement(i,{timeFrame:d.timeFrame,characteristics:r,limits:d.limits}):null;const h=e.createElement("div",null,e.createElement("h3",{style:{marginBlockStart:"0.2em",marginBlockEnd:0}},"Query limits:"),f.map((t,l)=>{const a=function(e,t){let n=Number.MAX_SAFE_INTEGER;return e.forEach(({name:e,rate:r})=>{const l=t[e],a="number"==typeof l&&0!==l&&0!==r?Math.floor(r/l):Number.MAX_SAFE_INTEGER;a<n&&(n=a)}),n}(t.limits,r),i=!!d&&t.timeFrame.interval===d.timeFrame.interval&&t.timeFrame.unit===d.timeFrame.unit,c=e.createElement("span",{onClick:()=>{return e=t,void u(d&&d.timeFrame.interval===e.timeFrame.interval&&d.timeFrame.unit===e.timeFrame.unit?null:e);var e},style:{fontStyle:"italic",textDecorationStyle:"dotted",cursor:"pointer",paddingLeft:10}},i?"hide...":"more...");return e.createElement("div",{key:l,style:{paddingLeft:"0.5em"}},e.createElement(n,{num:a}),"times per ",t.timeFrame.interval," ",t.timeFrame.unit,c,i?e.createElement(m,null):null)}));let v=g?e.createElement(e.Fragment,null,e.createElement("div",{style:{width:250,padding:"0.5em 0 0.5em 0.5em"}},h),e.createElement("div",{style:{flex:1,backgroundColor:"#444",color:"white",padding:"0.5em 0 0.5em 0.5em"}},g)):e.createElement(e.Fragment,null,e.createElement("div",{style:{flex:1,padding:"0.5em 0 0.5em 0.5em"}},h));return e.createElement("div",{style:{display:"flex",flexDirection:"row",width:"100%",height:"100%"}},v)}function s({dataAvailability:t,costData:n}){let r;switch(t){case"NONE":r=e.createElement("h3",{style:{color:"#cdcdcd",textAlign:"center"}},"No data yet");break;case"LOADING":r=e.createElement("h3",{style:{color:"#cdcdcd",textAlign:"center"}},"Loading...");break;case"ERROR":let t="Error loading cost data";if("object"==typeof n&&n&&n.errors){const r=Array.isArray(n.errors)?n.errors:[n.errors];t=e.createElement("ul",null,r.map(t=>e.createElement("li",null,t&&t.message||"")))}r=e.createElement("h3",{style:{color:"#cdcdcd",textAlign:"center"}},t);break;case"AVAILABLE":r="object"==typeof n&&"object"==typeof n.request&&"object"==typeof n.rateLimits?e.createElement(o,{characteristics:n.request,rateLimits:n.rateLimits}):"object"==typeof n.request?e.createElement(l,{characteristics:n.request}):e.createElement("h3",{style:{color:"#cdcdcd",textAlign:"center"}},"Error rendering cost data")}return e.createElement("div",{className:"qcs_wrapper"},r)}export{s as CostPlugin};
//# sourceMappingURL=index.modern.js.map
